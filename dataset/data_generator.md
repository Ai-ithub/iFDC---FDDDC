# مستندات کد تولید داده FDMS (Formation Damage Monitoring System)

---

## مقدمه
این کد برای تولید دیتاست شبیه‌سازی شده از داده‌های حفاری چاه‌های نفت نوشته شده است. هدف تولید داده‌هایی با ویژگی‌های نزدیک به داده‌های واقعی حفاری است تا در تحلیل‌های زمین‌شناسی، مدل‌سازی‌های ریسک و یادگیری ماشین استفاده شود.

---

## توضیح کلی
- داده‌ها برای ۱۰ چاه با مشخصات جغرافیایی متفاوت تولید می‌شوند.
- برای هر چاه حدود 15,552,000 رکورد (نمونه) داده که هرکدام فاصله زمانی یک ثانیه را دارند تولید می‌شود.
- داده‌ها شامل پارامترهای عددی، طبقه‌ای، ریسک‌های مختلف و شاخص‌های ترکیبی هستند.
- داده‌ها به صورت فایل‌های `Parquet` ذخیره می‌شوند.
- داده ها در طول 6 ماه ثبت شده اند.

---

## ستون‌های داده و توضیحات هرکدام

| نام ستون                 | نوع داده     | توضیح                                                       |
|--------------------------|--------------|------------------------------------------------------------|
| **Depth_m**              | عددی (float) | عمق حفاری بر حسب متر                                       |
| **Bit_Type**             | رشته (str)   | نوع مته استفاده شده (مثلاً "PDC", "Roller Cone", "Diamond")|
| **Formation_Type**       | رشته (str)   | نوع سنگ مخزن (مثلاً "Shale", "Sandstone", "Limestone")     |
| **Mud_Weight_ppg**       | عددی (float) | وزن گل حفاری (Mud weight) بر حسب پوند بر گالن             |
| **Fracture_Gradient_psi**| عددی (float) | شیب شکستگی سنگ به psi/ft                                   |
| **Water_Cut_percent**    | عددی (float) | درصد آب موجود در گل حفاری                                  |
| **Solid_Content_percent**| عددی (float) | درصد جامدات در گل حفاری                                    |
| **Shale_Reactivity**     | رشته (str)   | میزان واکنش‌پذیری شیل ("Low", "Medium", "High")            |
| **Formation_Temp_C**     | عددی (float) | دمای مخزن به درجه سانتی‌گراد                               |
| **Fluid_Loss_Risk**      | رشته (str)   | ریسک از دست دادن سیال بر اساس وزن گل و شیب شکستگی ("Low", "Medium", "High") |
| **Emulsion_Risk**        | رشته (str)   | ریسک ایجاد امولسیون در گل حفاری بر اساس نسبت نفت به آب و جامدات ("Low", "Medium", "High") |
| **Rock_Fluid_Reactivity**| رشته (str)   | امتیاز واکنش‌پذیری سنگ نسبت به سیالات ("Low", "Medium", "High") |
| **Formation_Damage_Index**| عددی (float)| شاخص ترکیبی آسیب مخزن (محاسبه شده بر اساس ریسک‌ها و پارامترهای دیگر) |
| **Outliers_Flag**        | بولین (bool) | نشانه‌دهنده داده پرت یا غیرمعمول                            |
| **Missing_Values_Flag**  | بولین (bool) | نشانه‌دهنده مقادیر گمشده در رکورد                           |
| **WELL_ID**              | رشته (str)   | شناسه چاه حفاری                                            |
| **Latitude**             | عددی (float) | عرض جغرافیایی چاه                                          |
| **Longitude**            | عددی (float) | طول جغرافیایی چاه                                         |
| **Timestamp**            | تاریخ (date) | زمان ثبت رکورد                                         |
---

## روند تولید داده‌ها

1. **تعریف اطلاعات چاه‌ها:**  
   مشخص کردن مختصات و شناسه ۱۰ چاه مختلف.

2. **تعریف پارامترهای اولیه:**  
   ثابت‌ها و پارامترهای اولیه مانند انواع سنگ، نوع مته، محدوده وزن گل و شیب شکستگی.

3. **تولید داده عددی:**  
   استفاده از توزیع‌های نرمال یا یکنواخت برای تولید مقادیر عمق، وزن گل، شیب شکستگی، درصد جامدات و...

4. **تخصیص مقادیر طبقه‌ای:**  
   انتخاب تصادفی نوع مته، نوع سنگ و واکنش‌پذیری شیل.

5. **محاسبه ریسک‌ها:**  
   - ریسک از دست دادن سیال (Fluid Loss Risk) بر اساس وزن گل و شیب شکستگی.  
   - ریسک امولسیون (Emulsion Risk) بر اساس نسبت نفت به آب و درصد جامدات.  
   - واکنش‌پذیری سنگ نسبت به سیالات (Rock Fluid Reactivity).

6. **ایجاد شاخص ترکیبی آسیب مخزن:**  
   ترکیب ریسک‌ها و پارامترهای مختلف به صورت عددی برای تعیین Formation Damage Index.

7. **افزودن داده‌های پرت:**  
   در حدود ۰.۲% از داده‌ها با مقادیر بسیار بالا یا پایین برای شبیه‌سازی داده‌های غیرعادی.

8. **افزودن مقادیر گمشده:**  
   به صورت تصادفی مقادیری در برخی ستون‌های عددی حذف می‌شوند.

9. **افزودن مشخصات چاه:**  
   هر رکورد شامل شناسه و موقعیت جغرافیایی چاه است.

10. **ذخیره داده‌ها:**  
    ذخیره هر دیتافریم چاه به صورت فایل Parquet در مسیر مشخص.

---

## مثال کد برای تولید یک نمونه داده

```python
import numpy as np
import pandas as pd

# تولید عمق حفاری با توزیع نرمال
depth = np.random.normal(loc=1500, scale=200, size=num_rows_per_well)

# وزن گل حفاری با توزیع یکنواخت بین 9.5 تا 15 ppg
mud_weight = np.random.uniform(9.5, 15, size=num_rows_per_well)

# انتخاب تصادفی نوع مته
bit_type = np.random.choice(["PDC", "Roller Cone", "Diamond"], size=num_rows_per_well)

# محاسبه ریسک از دست دادن سیال
def fluid_loss_risk(row):
    if row['Mud_Weight_ppg'] > row['Fracture_Gradient_psi']:
        return "High"
    elif abs(row['Mud_Weight_ppg'] - row['Fracture_Gradient_psi']) < 1:
        return "Medium"
    else:
        return "Low"

df = pd.DataFrame({
    "Depth_m": depth,
    "Mud_Weight_ppg": mud_weight,
    "Bit_Type": bit_type,
    # سایر ستون‌ها...
})

df["Fluid_Loss_Risk"] = df.apply(fluid_loss_risk, axis=1)
